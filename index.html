<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>PFCバランス計算機</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 16px; font-size: 16px; }
    .container { background: #fff; padding: 20px; border-radius: 10px; max-width: 100%; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 16px; font-weight: bold; }
    input, select, button {
      width: 100%; padding: 14px; margin-top: 8px; font-size: 16px;
      border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box;
    }
    input.error { border: 2px solid red; }
    button {
      background: #4CAF50; color: white; border: none; margin-top: 16px; cursor: pointer;
    }
    .result {
      background: #eaffea; padding: 16px; margin-top: 20px;
      border-radius: 6px; border-left: 5px solid #4CAF50; font-size: 16px; line-height: 1.6; overflow-x: auto;
    }
    .guide {
      margin-top: 24px;
    }
    .diet-card {
      background: #f9f9f9;
      padding: 12px;
      margin-top: 10px;
      border-left: 5px solid #4CAF50;
      border-radius: 6px;
    }
    .diet-card span {
      display: block;
      margin-top: 4px;
      font-weight: bold;
    }
    .diet-card.vlcd {
      background: #fff0f0;
      border-left-color: #e53935;
    }
    .diet-card .warning {
      color: red;
      font-weight: bold;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>PFCバランス計算機</h1>

    <label>総摂取カロリー（kcal）</label>
    <input type="number" id="totalCal" placeholder="例: 2000">

    <label>タンパク質の割合（%）</label>
    <input type="number" id="protein" placeholder="例: 30">

    <label>脂質の割合（%）</label>
    <input type="number" id="fat" placeholder="例: 20">

    <label>炭水化物の割合（%）</label>
    <input type="number" id="carb" placeholder="例: 50">

    <label>1日の食事回数</label>
    <select id="meals">
      <option value="1">1回</option>
      <option value="2">2回</option>
      <option value="3" selected>3回</option>
      <option value="4">4回</option>
      <option value="5">5回</option>
      <option value="6">6回</option>
    </select>

    <button onclick="calculate()">計算する</button>

    <div class="result" id="result" style="display:none;"></div>

    <div class="guide">
      <h2>PFCバランスの参考（ダイエット方針別）</h2>
      <p>代表的なダイエット方針ごとのPFCバランスの目安です。</p>

      <div class="diet-card">
        <strong>Low Fat（脂質制限）</strong><br>
        脂質を抑えて炭水化物を中心に摂る<br>
        <span>P: 25〜35% / F: 10〜20% / C: 45〜60%</span>
      </div>

      <div class="diet-card">
        <strong>Low Carb（炭水化物制限）</strong><br>
        炭水化物を抑えて脂質を活用する<br>
        <span>P: 30〜40% / F: 25〜35% / C: 20〜30%</span>
      </div>

      <div class="diet-card">
        <strong>VLC（Very Low Carb）</strong><br>
        極端に炭水化物を減らし、脂質中心（ケト系）<br>
        <span>P: 30〜35% / F: 55〜65% / C: 5〜10%</span>
      </div>

      <div class="diet-card vlcd">
        <strong>VLCD（Very Low Calorie Diet）</strong><br>
        医療向けの超低カロリー（800kcal未満）<br>
        <span>P: 30〜40% / F: 20〜30% / C: 30〜40%</span><br>
        <span class="warning">※ 医療管理下以外では行わないでください</span>
      </div>
    </div>
  </div>

  <script>
    function calculate() {
      const totalCal = parseFloat(document.getElementById("totalCal").value);
      const proteinRatio = parseFloat(document.getElementById("protein").value);
      const fatRatio = parseFloat(document.getElementById("fat").value);
      const carbRatio = parseFloat(document.getElementById("carb").value);
      const meals = parseInt(document.getElementById("meals").value);

      const inputs = ["totalCal", "protein", "fat", "carb"];
      let hasError = false;

      inputs.forEach(id => {
        const el = document.getElementById(id);
        el.classList.remove("error");
        if (!el.value || isNaN(parseFloat(el.value))) {
          el.classList.add("error");
          hasError = true;
        }
      });

      if (hasError) {
        alert("すべての値を正しく入力してください");
        return;
      }

      const totalRatio = proteinRatio + fatRatio + carbRatio;
      if (Math.round(totalRatio) !== 100) {
        ["protein", "fat", "carb"].forEach(id => document.getElementById(id).classList.add("error"));
        alert("P・F・Cの合計が100%になるように入力してください（現在: " + totalRatio.toFixed(1) + "%）");
        return;
      }

      const pCal = totalCal * (proteinRatio / 100);
      const fCal = totalCal * (fatRatio / 100);
      const cCal = totalCal * (carbRatio / 100);

      const pGram = Math.round(pCal / 4);
      const fGram = Math.round(fCal / 9);
      const cGram = Math.round(cCal / 4);

      const pPerMeal = Math.round(pGram / meals);
      const fPerMeal = Math.round(fGram / meals);
      const cPerMeal = Math.round(cGram / meals);
      const calPerMeal = Math.round(totalCal / meals);

      const result = document.getElementById("result");
      result.innerHTML = `
        <h2>1日の食事の目安</h2>
        <table>
          <thead>
            <tr><th>栄養素</th><th>合計 (g)</th><th>kcal</th><th>1食あたり (g)</th></tr>
          </thead>
          <tbody>
            <tr><td>タンパク質</td><td>${pGram}</td><td>${Math.round(pCal)}</td><td>${pPerMeal}</td></tr>
            <tr><td>脂質</td><td>${fGram}</td><td>${Math.round(fCal)}</td><td>${fPerMeal}</td></tr>
            <tr><td>炭水化物</td><td>${cGram}</td><td>${Math.round(cCal)}</td><td>${cPerMeal}</td></tr>
          </tbody>
        </table>
        <p><strong>1食あたりの合計カロリー:</strong> ${calPerMeal} kcal</p>
      `;
      result.style.display = "block";
    }
  </script>
</body>
</html>